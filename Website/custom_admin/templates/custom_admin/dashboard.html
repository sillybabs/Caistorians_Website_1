{% extends "Main/base.html" %}
{% block content %}
<h1>Admin Dashboard</h1>

<form method="get" style="margin-bottom:20px;">
    <input type="text" name="search" placeholder="Search users..." value="{{ search_query }}">
    <button type="submit">Search</button>
</form>

<h2>Users</h2>
<table border="1">
<tr><th>Username</th><th>Email</th><th>Actions</th></tr>
{% for user in users %}
<tr>
    <td>{{ user.username }}</td>
    <td>{{ user.email }}</td>
    <td><a href="{% url 'custom_admin:delete_user' user.id %}">Delete</a></td>
</tr>
{% endfor %}
</table>

<h2>Events</h2>
<table border="1">
<tr><th>Title</th><th>Date</th><th>Actions</th></tr>
{% for event in events %}
<tr>
    <td>{{ event.title }}</td>
    <td>{{ event.start_time }}</td>
    <td><a href="{% url 'custom_admin:delete_event' event.id %}">Delete</a></td>
</tr>
{% endfor %}
</table>

<h2>Photos</h2>
<table border="1">
<tr><th>Caption</th><th>Uploaded By</th><th>Approved</th><th>Actions</th></tr>
{% for photo in photos %}
<tr>
    <td>{{ photo.caption }}</td>
    <td>{{ photo.uploaded_by.username }}</td>
    <td>{{ photo.approved }}</td>
    <td>
        {% if not photo.approved %}<a href="{% url 'custom_admin:approve_photo' photo.id %}">Approve</a>{% endif %}
        <a href="{% url 'custom_admin:delete_photo' photo.id %}">Delete</a>
    </td>
</tr>
{% endfor %}
</table>

<h2>Stories</h2>
<table border="1">
<tr><th>Title</th><th>Author</th><th>Approved</th><th>Actions</th></tr>
{% for story in stories %}
<tr>
    <td>{{ story.title }}</td>
    <td>{{ story.author.username }}</td>
    <td>{{ story.approved }}</td>
    <td>
        {% if not story.approved %}<a href="{% url 'custom_admin:approve_story' story.id %}">Approve</a>{% endif %}
        <a href="{% url 'custom_admin:delete_story' story.id %}">Delete</a>
    </td>
</tr>
{% endfor %}
</table>

<h2>Reports</h2>
<table border="1">
<tr><th>Content Type</th><th>Content ID</th><th>Reporter</th><th>Reason</th><th>Actions</th></tr>
{% for report in reports %}
<tr>
    <td>{{ report.get_content_type_display }}</td>
    <td>{{ report.content_id }}</td>
    <td>{{ report.reporter.username }}</td>
    <td>{{ report.reason }}</td>
    <td><a href="{% url 'custom_:resolve_report' report.id %}">Mark Resolved</a></td>
</tr>
{% empty %}
<tr><td colspan="5">No reports.</td></tr>
{% endfor %}
</table>

<h2>Recent Admin Actions</h2>
<ul>
{% for log in logs %}
<li>{{ log.created_at }} â€” {{ log.admin.username }}: {{ log.action }}</li>
{% endfor %}
</ul>

{% endblock %}
